(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t){e.exports=require("electron")},36:function(e,t,n){e.exports=n(75)},41:function(e,t,n){},42:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},43:function(e,t,n){},44:function(e,t,n){},71:function(e,t){},74:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(34),s=n.n(i),c=(n(41),n(1)),o=n(2),u=n(4),h=n(3),l=n(5),m=(n(42),n(43),function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this))).state={value:""},e}return Object(l.a)(t,e),Object(o.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault(),this.props.onSubmit(this.state.value),this.setState({value:""})}},{key:"render",value:function(){var e=this,t=(this.props.onSubmit,this.state.value);return r.a.createElement("form",{className:"message-input",onSubmit:this.handleSubmit.bind(this)},r.a.createElement("input",{type:"text",placeholder:"Say...",value:t,onChange:function(t){return e.setState({value:t.target.value})}}),r.a.createElement("button",null,"Send"))}}]),t}(a.Component)),d=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this))).state={},e}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"message-row"},r.a.createElement("p",null,r.a.createElement("b",null,this.props.author),": ",this.props.message))}}]),t}(a.Component),v=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"message-container"},this.props.messages.map(function(e,t){return r.a.createElement(d,{author:e.name,message:e.message,key:t})}))}}]),t}(a.Component),p=(n(44),n(8)),E=n.n(p),f=n(20),b=n(47)(n(48));b.SERVER_URL="https://agile-peak-85163.herokuapp.com",b.VIDEO_ROUTE="/video/emitvideo",b.SCREEN_ROUTE="/video/stream",b.VIDEO_SUBSCRIBE_ROUTE="/video/sub",b.MESSAGE_SUBSCRIBE_ROUTE="/message/sub",b.MESSAGE_ROUTE="/message",b.MESSAGE_EVENT="message",b.SCREEN_EVENT="screenevent",b.VIDEO_EVENT="videoevent",b.sails.url=b.SERVER_URL;var O=b,S=function(){function e(){Object(c.a)(this,e),O.socket.get(O.MESSAGE_SUBSCRIBE_ROUTE)}return Object(o.a)(e,[{key:"get",value:function(){var e=Object(f.a)(E.a.mark(function e(){var t,n;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O.SERVER_URL+O.MESSAGE_ROUTE);case 2:return t=e.sent,e.next=5,t.json();case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"send",value:function(){var e=Object(f.a)(E.a.mark(function e(t,n){var a,r;return E.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(O.SERVER_URL+O.MESSAGE_ROUTE,{method:"POST",body:JSON.stringify({name:t,message:n})});case 2:return a=e.sent,e.next=5,a.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"listen",value:function(e,t){O.socket.on(O.MESSAGE_EVENT,e.bind(t))}}]),e}(),g=[{sender:"Lorem",message:"ipsum"}],j=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this))).state={messages:g},e}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.api=new S,this.api.get().then(function(t){return e.setState({messages:t})}),this.api.listen(function(t){var n=e.state.messages.slice();n.push(t),e.setState({messages:n})})}},{key:"sendMessage",value:function(e){this.api.send("Instructor",e)}},{key:"render",value:function(){return r.a.createElement("div",{className:"messenger-container"},r.a.createElement(v,{messages:this.state.messages}),r.a.createElement(m,{onSubmit:this.sendMessage.bind(this)}))}}]),t}(a.Component);O.socket.get(O.VIDEO_SUBSCRIBE_ROUTE);var y=function(){function e(t,n,a){var r=this;Object(c.a)(this,e),this.video=n,this.context=a.getContext("2d"),this.context.height=a.height,this.context.width=a.width,t(this.handleError.bind(this),this.handleStream.bind(this)),setInterval(function(){r.context.drawImage(n,0,0,r.context.width,r.context.height);var e="desktop"===t.type?O.SCREEN_ROUTE:O.VIDEO_ROUTE;O.socket.post(e,{video:a.toDataURL("image/webp")})},5)}return Object(o.a)(e,[{key:"handleStream",value:function(e){this.video.srcObject=e}},{key:"handleError",value:function(e){throw e}}]),e}(),k=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(u.a)(this,Object(h.a)(t).call(this))).video=r.a.createRef(),e.canvas=r.a.createRef(),e}return Object(l.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.videoSource;e&&new y(e,this.video.current,this.canvas.current)}},{key:"render",value:function(){return r.a.createElement("div",{className:"video-wrapper"},r.a.createElement("video",{autoPlay:!0,ref:this.video}),r.a.createElement("canvas",{ref:this.canvas,style:{display:"none"}}))}}]),t}(a.Component),R=(n(74),n(35));function w(e,t){navigator.mediaDevices.getUserMedia({video:{width:1280,height:720},audio:!1}).then(t).catch(e)}function _(e,t){R.desktopCapturer.getSources({types:["window","screen"]},function(n,a){if(n)throw n;var r=a.find(function(e){return"Entire screen"===e.name});navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r.id,minWidth:1280,maxWidth:1280,minHeight:720,maxHeight:720}}}).then(t).catch(e)})}w.type="webcam",_.type="desktop";var U=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"videostream-container"},r.a.createElement(k,{videoSource:_,title:"desktop"}),r.a.createElement(k,{videoSource:w,title:"webcam"}))}}]),t}(a.Component),x=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(h.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App"},r.a.createElement(j,null),r.a.createElement(U,null))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[36,1,2]]]);
//# sourceMappingURL=main.fc6b6715.chunk.js.map